Changed synchronization scheme to achieve full passing tests on

- Windows, Linux, MacOS
- CPython 3.6, 3.7, 3.8, 3.9
- Pypy 3.6, 3.7